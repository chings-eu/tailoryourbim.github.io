<!DOCTYPE html>
<html lang="en"><head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5QTTTRNC1H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5QTTTRNC1H');
  </script>

  <meta property="og:image" content="https://discordapp.com/assets/ba74954dde74ff40a32ff58069e78c36.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="250">
  <meta property="og:image:height" content="250">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Fit Active Workset And Element Workset | tailor . your . bim</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Fit Active Workset And Element Workset" />
<meta name="author" content="Ching" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’m Ching, your BIM tailor." />
<meta property="og:description" content="I’m Ching, your BIM tailor." />
<link rel="canonical" href="http://localhost:4000/revitexternalcommand/Fit-Active-Workset-And-Element-Workset/" />
<meta property="og:url" content="http://localhost:4000/revitexternalcommand/Fit-Active-Workset-And-Element-Workset/" />
<meta property="og:site_name" content="tailor . your . bim" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-14T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fit Active Workset And Element Workset" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ching"},"dateModified":"2018-10-14T00:00:00+02:00","datePublished":"2018-10-14T00:00:00+02:00","description":"I’m Ching, your BIM tailor.","headline":"Fit Active Workset And Element Workset","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/revitexternalcommand/Fit-Active-Workset-And-Element-Workset/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logoty.png"},"name":"Ching"},"url":"http://localhost:4000/revitexternalcommand/Fit-Active-Workset-And-Element-Workset/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png"<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="tailor . your . bim" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><!-- <a class="site-title" rel="author" href="/">tailor . your . bim</a> -->

    <a class="site-title" rel="author" href="/">
      <img src="/assets/img/logoty.png" alt="Logo" width="28px"> 
      <span>&nbsp;&nbsp;tailor . your . bim</span>
        
      
      <!-- <span style='color: #B042FF;'>T</span>
      <span style='color: #939393;'>ailor . </span>
      <span style='color: #01bbd4;'>Y</span>
      <span style='color: #939393;'>our . BIM </span> -->
    </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/contact/">Contact</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>

<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Fit Active Workset And Element Workset</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-10-14T00:00:00+02:00" itemprop="datePublished">Oct 14, 2018
      </time></p>
  </header>

  <div class="post-categories"><a herf="/categories/#RevitExternalCommand">RevitExternalCommand</a>&nbsp;|&nbsp;<a herf="/tags/#f#">f#</a>&nbsp;/&nbsp;<a herf="/tags/#revit api">revit api</a>&nbsp;/&nbsp;<a herf="/tags/#workset">workset</a></div>
  
  <div class="post-content e-content" itemprop="articleBody">
    <script src="/assets/signup/signup.js"></script>

<signup-component></signup-component>

<p>It has been said that using Worksets in Revit is like using layers, analog to AutoCAD or Rhino. Apart from that, working with a work-shared model and manipulating the worksets, either quickly switching / activating between worksets or assigning elements to worksets, can simply improve our working efficiency – at least the additional possibility to change the visibility of each workset in views is already an improvement.</p>

<p>Even this improvement can be further improved. Imagine we’d have to change the active workset often, in order to put the newly created element into correct “layers” – i.e. worksets. Every time you switch the workset, your mouse cursor have to move down the screen and activate the workset you want then you can create elements. This moving up and down frequently actually costs time and your wrist. Why not make your own command to switch and assign between workset more efficiently?</p>

<figure class="highlight"><pre><code class="language-fsharp" data-lang="fsharp"><span class="k">type</span> <span class="nc">FitWorkset</span><span class="bp">()</span> <span class="k">as</span> <span class="n">this</span> <span class="p">=</span>
  <span class="k">interface</span> <span class="nc">IExternalCommand</span> <span class="k">with</span>
    <span class="k">member</span> <span class="n">x</span><span class="p">.</span><span class="nc">Execute</span><span class="p">(</span><span class="n">cdata</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">elset</span><span class="p">)</span> <span class="p">=</span>
      <span class="k">let</span> <span class="n">uidoc</span> <span class="p">=</span> <span class="n">cdata</span><span class="p">.</span><span class="nn">Application</span><span class="p">.</span><span class="nc">ActiveUIDocument</span>
      <span class="k">let</span> <span class="n">selected</span> <span class="p">=</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Selection</span><span class="p">.</span><span class="nc">GetElementIds</span><span class="bp">()</span> <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nc">GetElement</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">ofSeq</span>
      <span class="k">match</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nc">IsWorkshared</span> <span class="k">with</span>
      <span class="p">|</span> <span class="bp">false</span> <span class="p">-&gt;</span>
        <span class="n">msg</span> <span class="p">&lt;-</span> <span class="s2">"File is not workshared."</span>
        <span class="nn">Result</span><span class="p">.</span><span class="nc">Cancelled</span>
      <span class="p">|</span> <span class="bp">true</span> <span class="p">-&gt;</span>
        <span class="k">let</span> <span class="n">namWsTo</span> <span class="p">=</span> <span class="s2">"02"</span>
        <span class="k">let</span> <span class="n">col</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">FilteredWorksetCollector</span><span class="p">(</span><span class="n">uidoc</span><span class="p">.</span><span class="nc">Document</span><span class="p">)</span>
        <span class="k">let</span> <span class="n">ws</span> <span class="p">=</span> <span class="n">col</span><span class="p">.</span><span class="nc">ToWorksets</span><span class="bp">()</span> <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="k">fun</span> <span class="n">w</span> <span class="p">-&gt;</span> <span class="n">namWsTo</span> <span class="p">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">item</span> <span class="mi">0</span> <span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="nn">Name</span><span class="p">.</span><span class="nc">Split</span> <span class="k">'</span><span class="p">_</span><span class="k">'</span><span class="o">))</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">ofSeq</span>
        <span class="k">match</span> <span class="n">ws</span> <span class="k">with</span>
        <span class="p">|</span> <span class="bp">[]</span> <span class="p">-&gt;</span>
          <span class="n">msg</span> <span class="p">&lt;-</span> <span class="s2">"No such keyword of workset"</span>
          <span class="nn">Result</span><span class="p">.</span><span class="nc">Cancelled</span>
        <span class="p">|</span> <span class="p">[</span><span class="n">ws</span><span class="p">]</span> <span class="p">-&gt;</span>
          <span class="k">let</span> <span class="n">tblWorkset</span> <span class="p">=</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nc">GetWorksetTable</span><span class="bp">()</span>
          <span class="k">match</span> <span class="n">selected</span> <span class="k">with</span>
          <span class="p">|</span> <span class="bp">[]</span> <span class="p">-&gt;</span> 
            <span class="n">tblWorkset</span><span class="p">.</span><span class="nc">SetActiveWorksetId</span><span class="p">(</span><span class="n">ws</span><span class="p">.</span><span class="nc">Id</span><span class="p">)</span>
          <span class="p">|</span> <span class="p">_</span> <span class="p">-&gt;</span>
            <span class="k">let</span> <span class="n">bip</span> <span class="p">=</span> <span class="nn">BuiltInParameter</span><span class="p">.</span><span class="nc">ELEM_PARTITION_PARAM</span>
            <span class="k">let</span> <span class="n">t</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">Transaction</span><span class="p">(</span><span class="n">uidoc</span><span class="p">.</span><span class="nc">Document</span><span class="p">,</span> <span class="kt">string</span> <span class="n">this</span><span class="p">)</span>
            <span class="n">t</span><span class="p">.</span><span class="nc">Start</span><span class="bp">()</span> <span class="p">|&gt;</span> <span class="n">ignore</span>
            <span class="n">selected</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">iter</span><span class="p">(</span><span class="k">fun</span> <span class="n">e</span> <span class="p">-&gt;</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">get_Parameter</span><span class="p">(</span><span class="n">bip</span><span class="o">)).</span><span class="nc">Set</span><span class="p">(</span><span class="n">ws</span><span class="p">.</span><span class="nn">Id</span><span class="p">.</span><span class="nc">IntegerValue</span><span class="p">)</span> <span class="p">|&gt;</span> <span class="n">ignore</span><span class="p">)</span>
            <span class="n">t</span><span class="p">.</span><span class="nc">Commit</span><span class="bp">()</span> <span class="p">|&gt;</span> <span class="n">ignore</span>
          <span class="nn">Result</span><span class="p">.</span><span class="nc">Succeeded</span>
          <span class="p">|</span> <span class="p">_</span> <span class="p">-&gt;</span>
            <span class="n">msg</span> <span class="p">&lt;-</span> <span class="s2">"Keyword refer to more than one workset"</span>
            <span class="nn">Result</span><span class="p">.</span><span class="nc">Cancelled</span></code></pre></figure>

<p>The concept of this code is, firstly, checking if the document is work-shared, if not then the command is cancelled since it has no worksets created by users; and secondly, checking if any elements are pre-selected. After the first checking, we know the file is work-shared and we’ll find the workset, which we want to activate or assign to the elements, at first (line 18). If the workset with the keyword is not available and the list will contain nothing, the program returns an error message (line 21) and is cancelled. Otherwise, the program is split further into two cases: at one hand, if there is only one workset left at the end of filtering workset lists according to given keyword (line 23), then this workset will be further operated, otherwise in the rest of the cases, meaning more than one workset returned, the program will be terminated with cancellation and replying with error message (line 36). How the chosen workset is being operated depends on if there is any element selected prior to the starting point of running this program. If so, it is implied that these elements are meant to be assigned with the chosen workset, but if nothing is selected which implies we just want the chosen workset to be active. Assigning the active workset is by retrieving the workset table and using SetActiveWorksetId() method without initialization of a new transaction, which is contrary to assign workset parameter to elements by setting with the IntergerValue of the chosen workset’s id.</p>

<p>To be continued…</p>

  </div><a class="u-url" href="/revitexternalcommand/Fit-Active-Workset-And-Element-Workset/" hidden></a>
</article>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">tailor . your . bim</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>© 2025 Chings e.U.</li>
          <li class="p-name">Ching</li><li><a class="u-email" href="mailto:info@tailoryourbim.com">info@tailoryourbim.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/chings-eu"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">chings-eu</span></a></li><li><a href="https://www.linkedin.com/in/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">tailoryourbim</span></a></li><li><a href="https://www.twitter.com/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">tailoryourbim</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>I&#39;m Ching, your BIM tailor.</p>
      </div>
    </div>

  </div>

</footer>
</body>
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</html>
