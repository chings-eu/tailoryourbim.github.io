<!DOCTYPE html>
<html lang="en"><head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5QTTTRNC1H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5QTTTRNC1H');
  </script>

  <meta property="og:image" content="https://discordapp.com/assets/ba74954dde74ff40a32ff58069e78c36.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="250">
  <meta property="og:image:height" content="250">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Create Floor From Room Outlines | Tailor Your BIM</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Create Floor From Room Outlines" />
<meta name="author" content="Ching" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ching’s here, your tailor for BIM." />
<meta property="og:description" content="Ching’s here, your tailor for BIM." />
<link rel="canonical" href="http://localhost:4000/revitexternalcommand/Create-Floor-From-Room-Outlines/" />
<meta property="og:url" content="http://localhost:4000/revitexternalcommand/Create-Floor-From-Room-Outlines/" />
<meta property="og:site_name" content="Tailor Your BIM" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-09-30T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Create Floor From Room Outlines" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ching"},"dateModified":"2018-09-30T00:00:00+02:00","datePublished":"2018-09-30T00:00:00+02:00","description":"Ching’s here, your tailor for BIM.","headline":"Create Floor From Room Outlines","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/revitexternalcommand/Create-Floor-From-Room-Outlines/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logoty.png"},"name":"Ching"},"url":"http://localhost:4000/revitexternalcommand/Create-Floor-From-Room-Outlines/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png"<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Tailor Your BIM" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><!-- <a class="site-title" rel="author" href="/">Tailor Your BIM</a> -->

    <a class="site-title" rel="author" href="/">
      <img src="/assets/img/logoty.png" alt="Logo" width="48px"> 
      <!-- <span>&nbsp;&nbsp;Tailor Your BIM</span> -->
        
      
      <!-- <span style='color: #B042FF;'>T</span>
      <span style='color: #939393;'>ailor . </span>
      <span style='color: #01bbd4;'>Y</span>
      <span style='color: #939393;'>our . BIM </span> -->
    </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/contact/">Contact</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>

<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Create Floor From Room Outlines</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-09-30T00:00:00+02:00" itemprop="datePublished">Sep 30, 2018
      </time></p>
  </header>

  <div class="post-categories"><a herf="/categories/#RevitExternalCommand">RevitExternalCommand</a>&nbsp;|&nbsp;<a herf="/tags/#floor">floor</a>&nbsp;/&nbsp;<a herf="/tags/#room">room</a>&nbsp;/&nbsp;<a herf="/tags/#f#">f#</a>&nbsp;/&nbsp;<a herf="/tags/#revit api">revit api</a></div>
  
  <div class="post-content e-content" itemprop="articleBody">
    <script src="/assets/signup/signup.js"></script>

<signup-component></signup-component>

<p>By using default Revit’s tools, one can create ceiling automatically. However, to create floors, by default, one has to draw the outlines by hand. Although, luckily, we can draw the outlines by selecting the edges from the adjacent elements, sometimes if we are not so lucky, we will probably select the wrong one and it’s time-consuming to erase the last one and select again. It happens, for example, when we have more than one layer of wall elements over each other and the thinner one at front stands over the floor, whereas the inner wall element is outer circumference of the floor element, and its edge is supposed to be selected.</p>

<p>A much useful tool, drawing automatically floors, doesn’t exist yet, maybe one can found something in the forums, but not in the default Revit tools, as far as I know. However, it’s actually rather easy to write one by yourself. The process is simple, just like you can imagine how you draw them by hand: select the edges of the adjacent elements – walls, columns… etc. These elements are mostly room-binding, which means the outline of a floor would be similar in the form of the room, and one just needs to define until which room-binding element the floor is supposed to be constructed – not only in model but also in reality.</p>

<p>In the case above, there could be more than one wall layers, or, technically speaking, more than one room-binding element overlapping, what can we do about it?  In my experience, with this modelling rules, the front layer is mostly a covering of the standing walls and in our project we name their types in a standard way and move them to a certain workset. Which means we can easily select them all at once and make them not room-binding. Then each room will have their circumference extending to the inner standing walls. In this case the outline of the room will have the form of our desired floor.</p>

<figure class="highlight"><pre><code class="language-fsharp" data-lang="fsharp"><span class="k">type</span> <span class="nc">CreateFloorByRoom</span><span class="bp">()</span> <span class="k">as</span> <span class="n">this</span> <span class="p">=</span>
  <span class="k">interface</span> <span class="nc">IExternalCommand</span> <span class="k">with</span>
    <span class="k">member</span> <span class="n">x</span><span class="p">.</span><span class="nc">Execute</span><span class="p">(</span><span class="n">cdata</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">elset</span><span class="p">)</span> <span class="p">=</span>
      <span class="k">let</span> <span class="n">uiapp</span> <span class="p">=</span> <span class="n">cdata</span><span class="p">.</span><span class="nc">Application</span>
      <span class="k">let</span> <span class="n">uidoc</span> <span class="p">=</span> <span class="n">uiapp</span><span class="p">.</span><span class="nc">ActiveUIDocument</span>
      <span class="k">let</span> <span class="n">selected</span> <span class="p">=</span> 
        <span class="n">uidoc</span><span class="p">.</span><span class="nn">Selection</span><span class="p">.</span><span class="nc">GetElementIds</span><span class="bp">()</span> 
        <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nc">GetElement</span> 
        <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span><span class="p">(</span>
          <span class="k">fun</span> <span class="n">e</span> <span class="p">-&gt;</span> 
            <span class="k">match</span> <span class="n">e</span> <span class="k">with</span>
            <span class="p">|</span> <span class="o">:?</span> <span class="nc">Room</span> <span class="p">-&gt;</span> <span class="bp">true</span>
            <span class="p">|</span> <span class="p">_</span> <span class="p">-&gt;</span> <span class="bp">false</span>
        <span class="p">)</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">ofSeq</span>
      <span class="k">match</span> <span class="n">selected</span> <span class="k">with</span>
      <span class="p">|</span> <span class="bp">[]</span> <span class="p">-&gt;</span> 
        <span class="n">msg</span> <span class="p">&lt;-</span> <span class="s2">"Select Room(s)"</span>
        <span class="nn">Result</span><span class="p">.</span><span class="nc">Cancelled</span>
      <span class="p">|</span> <span class="p">_</span> <span class="k">as</span> <span class="n">sel</span> <span class="p">-&gt;</span>
        <span class="k">let</span> <span class="n">t</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">Transaction</span><span class="p">(</span><span class="n">uidoc</span><span class="p">.</span><span class="nc">Document</span><span class="p">,</span> <span class="kt">string</span> <span class="n">this</span><span class="p">)</span>
        <span class="n">t</span><span class="p">.</span><span class="nc">Start</span><span class="bp">()</span> <span class="p">|&gt;</span> <span class="n">ignore</span>
        <span class="n">sel</span> <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">cast</span><span class="p">&lt;</span><span class="nc">Room</span><span class="p">&gt;</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">ofSeq</span>
        <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="p">(</span>
          <span class="k">fun</span> <span class="n">rm</span> <span class="p">-&gt;</span>
            <span class="k">let</span> <span class="n">curvearray</span> <span class="p">=</span>
              <span class="n">rm</span><span class="p">.</span><span class="nc">GetBoundarySegments</span><span class="p">(</span><span class="k">new</span> <span class="nc">SpatialElementBoundaryOptions</span><span class="bp">()</span><span class="p">)</span> 
              <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">fun</span> <span class="n">seqSeg</span> <span class="p">-&gt;</span>  
                  <span class="k">let</span> <span class="n">cary</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">CurveArray</span><span class="bp">()</span>
                  <span class="n">seqSeg</span> <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">iter</span><span class="p">(</span><span class="k">fun</span> <span class="n">sg</span> <span class="p">-&gt;</span> <span class="n">cary</span><span class="p">.</span><span class="nc">Append</span> <span class="p">(</span><span class="n">sg</span><span class="p">.</span><span class="nc">GetCurve</span><span class="bp">()</span><span class="o">))</span>
                  <span class="n">cary</span>
              <span class="p">)</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">ofSeq</span>
            <span class="k">match</span> <span class="n">curvearray</span> <span class="k">with</span>
            <span class="p">|</span> <span class="bp">[]</span> <span class="p">-&gt;</span> <span class="n">failwith</span> <span class="s2">"Unknown error with the room"</span>
            <span class="p">|</span> <span class="p">[</span><span class="n">cary</span><span class="p">]</span> <span class="p">-&gt;</span>
              <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nn">Create</span><span class="p">.</span><span class="nc">NewFloor</span><span class="p">(</span><span class="n">cary</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span> <span class="p">|&gt;</span> <span class="n">ignore</span>
              <span class="bp">()</span>
            <span class="p">|</span> <span class="n">hd</span><span class="p">::</span><span class="n">tl</span> <span class="p">-&gt;</span>
              <span class="k">let</span> <span class="n">flr</span> <span class="p">=</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nn">Create</span><span class="p">.</span><span class="nc">NewFloor</span><span class="p">(</span><span class="n">hd</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span>
              <span class="n">tl</span>
              <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">iter</span><span class="p">(</span><span class="k">fun</span> <span class="n">cary</span> <span class="p">-&gt;</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nn">Create</span><span class="p">.</span><span class="nc">NewOpening</span><span class="p">(</span><span class="n">flr</span><span class="p">,</span> <span class="n">cary</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span> <span class="p">|&gt;</span> <span class="n">ignore</span><span class="p">)</span>
              <span class="bp">()</span>
        <span class="p">)</span>
        <span class="p">|&gt;</span> <span class="n">ignore</span>
        <span class="n">t</span><span class="p">.</span><span class="nc">Commit</span><span class="bp">()</span> <span class="p">|&gt;</span> <span class="n">ignore</span>
        <span class="nn">Result</span><span class="p">.</span><span class="nc">Succeeded</span></code></pre></figure>

<p>Naturally, the first step of the code is getting the rooms which are selected elements prior to running this command. To secure that it runs only when elements are selected, here we check whether the list of selected elements is empty. If so, a pop-up of error will come up says “Select Room(s)”, terminates the code and gives result as a cancellation (Line 26). If not, it works on the list further by starting a transaction at first(Line 29), and then, after casting all selected elements as rooms, we can retrieve the outlines out of rooms.</p>

<p>The outlines of a room are saved as its boundary segments and available by calling GetBoundarySegments() with an instance of SpatialElementBoundaryOptions. These boundary segments are collected in generic lists within a generic list. Before we are getting into the next step, we should take a look at the structure of these lists.</p>

<p>In the first item of the outer generic list are the segments of the outermost outlines, and the rest items – if there is any – are the inner outlines within a room, where the inner boundaries are. For example, if we have a room or a column with a room, which we want to create a floor element from, then the first item, i.e. the inner list, will be the outermost outlines and the outlines of the inner boundaries and of the column will be the rest items. The segments from the rest items will be the outlines where we “cut out” the floor element, and for doing that with Revit API, we create opening elements with the floor as their host element.</p>

<p>As much of the said, let’s have a short look at the codes. We convert the generic list of boundary segments into an F# list, with which we make pattern comparison that we can be sure or distinguish the different processes in cases of nothing in the list, only one item in the list – which means there is no inner boundary within the room, and more than one item in the outermost list, where we use head and tail pattern to retrieve first and the rest list items.</p>

<p>Hopefully, more or less it introduces a bit of how to automatically create floor elements and leads to an interest of writing automation for Revit. If there is any question or feedback, feel free to leave comments and stay tuned!</p>

  </div><a class="u-url" href="/revitexternalcommand/Create-Floor-From-Room-Outlines/" hidden></a>
</article>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <p>
       <!-- <h2>Tailor Your BIM</h2> -->
      <!-- <h2 class="footer-heading">Tailor Your BIM</h2> -->
      <img src="/assets/img/logoty.png" alt="Logo" width="42px">
    </p>
    
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          
          <li>© 2025 Chings e.U.</li>
          <li class="p-name">Ching</li><li><a class="u-email" href="mailto:info@tailoryourbim.com">info@tailoryourbim.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/chings-eu"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">chings-eu</span></a></li><li><a href="https://www.linkedin.com/in/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">tailoryourbim</span></a></li><li><a href="https://www.twitter.com/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">tailoryourbim</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ching&#39;s here, your tailor for BIM.</p>
      </div>
    </div>

  </div>

</footer>
</body>
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</html>
