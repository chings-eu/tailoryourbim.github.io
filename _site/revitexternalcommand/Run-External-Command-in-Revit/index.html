<!DOCTYPE html>
<html lang="en"><head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5QTTTRNC1H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5QTTTRNC1H');
  </script>

  <meta property="og:image" content="https://discordapp.com/assets/ba74954dde74ff40a32ff58069e78c36.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="250">
  <meta property="og:image:height" content="250">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Run External Command in Revit 加入Revit外部指令 | Tailor Your BIM</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Run External Command in Revit 加入Revit外部指令" />
<meta name="author" content="Ching" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ching’s here, your tailor for BIM." />
<meta property="og:description" content="Ching’s here, your tailor for BIM." />
<link rel="canonical" href="http://localhost:4000/revitexternalcommand/Run-External-Command-in-Revit/" />
<meta property="og:url" content="http://localhost:4000/revitexternalcommand/Run-External-Command-in-Revit/" />
<meta property="og:site_name" content="Tailor Your BIM" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-11T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Run External Command in Revit 加入Revit外部指令" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ching"},"dateModified":"2018-03-11T00:00:00+01:00","datePublished":"2018-03-11T00:00:00+01:00","description":"Ching’s here, your tailor for BIM.","headline":"Run External Command in Revit 加入Revit外部指令","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/revitexternalcommand/Run-External-Command-in-Revit/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logoty.png"},"name":"Ching"},"url":"http://localhost:4000/revitexternalcommand/Run-External-Command-in-Revit/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png"<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Tailor Your BIM" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><!-- <a class="site-title" rel="author" href="/">Tailor Your BIM</a> -->

    <a class="site-title" rel="author" href="/">
      <img src="/assets/img/logoty.png" alt="Logo" width="48px"> 
      <!-- <span>&nbsp;&nbsp;Tailor Your BIM</span> -->
        
      
      <!-- <span style='color: #B042FF;'>T</span>
      <span style='color: #939393;'>ailor . </span>
      <span style='color: #01bbd4;'>Y</span>
      <span style='color: #939393;'>our . BIM </span> -->
    </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/contact/">Contact</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>

<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Run External Command in Revit | 加入Revit外部指令</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-03-11T00:00:00+01:00" itemprop="datePublished">Mar 11, 2018
      </time></p>
  </header>

  <div class="post-categories"><a herf="/categories/#RevitExternalCommand">RevitExternalCommand</a>&nbsp;|&nbsp;<a herf="/tags/#f#">f#</a>&nbsp;/&nbsp;<a herf="/tags/#revit api">revit api</a>&nbsp;/&nbsp;<a herf="/tags/#external command">external command</a></div>
  
  <div class="post-content e-content" itemprop="articleBody">
    <script src="/assets/signup/signup.js"></script>

<signup-component></signup-component>

<p>After we’ve created a simple message command, we can now register the compiled dynamic-link library file (.dll) into Revit program.</p>

<p>For doing that, we have to create an add-in file.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=”1.0″ encoding=”utf-8″?&gt;</span>
<span class="nt">&lt;RevitAddIns&gt;</span>
<span class="nt">&lt;AddIn</span> <span class="na">Type=</span><span class="s">”Command”</span><span class="nt">&gt;</span></code></pre></figure>

<p>Second, where the assembly(.dll file), which we have compiled, is, and to which this add-in is linked. For the convenience of debugging, I’d directly point this add-in file to the one .dll which is in the debug directory, re-built from Visual Studio program.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml">    <span class="nt">&lt;Assembly&gt;</span>fs-revit.dll<span class="nt">&lt;/Assembly&gt;</span></code></pre></figure>

<p>Two important features as the following code are the FullClassName and AddInId tags. The former can be found by hovering your mouse cursor over the line in Visual Studio where type/class is declared and it is usually formed as “namespace.classname”. As to the later one, “AddInId”, it can be online generated, and each add-in file pointing to your Revit program, the assembly, must have a unique id number.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml">    <span class="nt">&lt;FullClassName&gt;</span>TYB.Tutorial.FSRevit.ASimpleMessage<span class="nt">&lt;/FullClassName&gt;</span>
    <span class="nt">&lt;AddInId&gt;</span>04a6882f-6d70-408b-b9bb-c7391c733a5f<span class="nt">&lt;/AddInId&gt;</span></code></pre></figure>

<p>And then, a few essential attribute tags describing the command and the .dll file to register. More information about the add-in tags can be found by following the registration link above.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml">    <span class="nt">&lt;Text&gt;</span>Level01: Revit Returns A Simple Message<span class="nt">&lt;/Text&gt;</span>
    <span class="nt">&lt;VendorId&gt;</span>TYB<span class="nt">&lt;/VendorId&gt;</span>
    <span class="nt">&lt;VendorDescription&gt;</span>tailoryourbim.com<span class="nt">&lt;/VendorDescription&gt;</span>
    <span class="nt">&lt;VisibilityMode&gt;</span>AlwaysVisible<span class="nt">&lt;/VisibilityMode&gt;</span>
    <span class="nt">&lt;Discipline&gt;</span>Any<span class="nt">&lt;/Discipline&gt;</span></code></pre></figure>

<p>Finally, the tail tags for closing up the xml file.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;/AddIn&gt;</span>
<span class="nt">&lt;/RevitAddIns&gt;</span></code></pre></figure>

<p>Now save this file to the add-in folder, which usually is located at:</p>

<p><em>C:\Users\UserName\AppData\Roaming\Autodesk\Revit\Addins\2017</em></p>

<p>After the file is copying into this folder, if your Revit is running, a dialog window will pop-up asking if the add-in is to load, if not, start Revit and the pop-up will show up. After loading the add-in you can find the command button located in external command panel within the Add-In tab.</p>

  </div><a class="u-url" href="/revitexternalcommand/Run-External-Command-in-Revit/" hidden></a>
</article>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <p>
       <!-- <h2>Tailor Your BIM</h2> -->
      <!-- <h2 class="footer-heading">Tailor Your BIM</h2> -->
      <img src="/assets/img/logoty.png" alt="Logo" width="42px">
    </p>
    
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          
          <li>© 2025 Chings e.U.</li>
          <li class="p-name">Ching</li><li><a class="u-email" href="mailto:info@tailoryourbim.com">info@tailoryourbim.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/chings-eu"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">chings-eu</span></a></li><li><a href="https://www.linkedin.com/in/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">tailoryourbim</span></a></li><li><a href="https://www.twitter.com/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">tailoryourbim</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ching&#39;s here, your tailor for BIM.</p>
      </div>
    </div>

  </div>

</footer>
</body>
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</html>
