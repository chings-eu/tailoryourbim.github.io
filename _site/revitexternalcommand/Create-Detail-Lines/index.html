<!DOCTYPE html>
<html lang="en"><head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5QTTTRNC1H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5QTTTRNC1H');
  </script>

  <meta property="og:image" content="https://discordapp.com/assets/ba74954dde74ff40a32ff58069e78c36.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="250">
  <meta property="og:image:height" content="250">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Create Detail Lines | tailor . your . bim</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Create Detail Lines" />
<meta name="author" content="Ching" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’m Ching, your BIM tailor." />
<meta property="og:description" content="I’m Ching, your BIM tailor." />
<link rel="canonical" href="http://localhost:4000/revitexternalcommand/Create-Detail-Lines/" />
<meta property="og:url" content="http://localhost:4000/revitexternalcommand/Create-Detail-Lines/" />
<meta property="og:site_name" content="tailor . your . bim" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-07-22T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Create Detail Lines" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ching"},"dateModified":"2018-07-22T00:00:00+02:00","datePublished":"2018-07-22T00:00:00+02:00","description":"I’m Ching, your BIM tailor.","headline":"Create Detail Lines","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/revitexternalcommand/Create-Detail-Lines/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logoty.png"},"name":"Ching"},"url":"http://localhost:4000/revitexternalcommand/Create-Detail-Lines/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png"<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="tailor . your . bim" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><!-- <a class="site-title" rel="author" href="/">tailor . your . bim</a> -->

    <a class="site-title" rel="author" href="/">
      <img src="/assets/img/logoty.png" alt="Logo" width="28px"> 
      <span>&nbsp;&nbsp;tailor . your . bim</span>
        
      
      <!-- <span style='color: #B042FF;'>T</span>
      <span style='color: #939393;'>ailor . </span>
      <span style='color: #01bbd4;'>Y</span>
      <span style='color: #939393;'>our . BIM </span> -->
    </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/contact/">Contact</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>

<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Create Detail Lines | </h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-07-22T00:00:00+02:00" itemprop="datePublished">Jul 22, 2018
      </time></p>
  </header>

  <div class="post-categories"><a herf="/categories/#RevitExternalCommand">RevitExternalCommand</a>&nbsp;|&nbsp;<a herf="/tags/#f#">f#</a>&nbsp;/&nbsp;<a herf="/tags/#revit api">revit api</a>&nbsp;/&nbsp;<a herf="/tags/#create">create</a>&nbsp;/&nbsp;<a herf="/tags/#detail line">detail line</a></div>
  
  <div class="post-content e-content" itemprop="articleBody">
    <script src="/assets/signup/signup.js"></script>

<signup-component></signup-component>

<p>So now, we can already select element in Revit and connect them with our code. Next you might ask: how do we create things in Revit by running our code? For starters, let take look at a simple example, say, we want to choose arbitrary three points in Revit and create lines by connecting points on the two lines, which divide the two lines into, say, n parts:</p>

<p>This process to draw with the code is just like the process that we can imagine when we draw in Revit by hand: get three points, draw two lines between them, divide them into n parts with points and connect points from one line to another in the oder of the parameters on each line.</p>

<figure class="highlight"><pre><code class="language-fsharp" data-lang="fsharp"><span class="k">type</span> <span class="nc">CreateDetailLines</span><span class="bp">()</span> <span class="p">=</span> 
  <span class="k">interface</span> <span class="nc">IExternalCommand</span> <span class="k">with</span>
    <span class="k">member</span> <span class="n">x</span><span class="p">.</span><span class="nc">Execute</span><span class="p">(</span><span class="n">cdata</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">elset</span><span class="p">)</span> <span class="p">=</span>
      <span class="k">let</span> <span class="n">uiapp</span> <span class="p">=</span> <span class="n">cdata</span><span class="p">.</span><span class="nc">Application</span>
      <span class="k">let</span> <span class="n">uidoc</span> <span class="p">=</span> <span class="n">uiapp</span><span class="p">.</span><span class="nc">ActiveUIDocument</span>
      <span class="k">let</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">uidoc</span><span class="p">.</span><span class="nc">Document</span>
      <span class="k">let</span> <span class="n">threepoints</span> <span class="p">=</span> 
        <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="k">fun</span> <span class="p">_</span> <span class="p">-&gt;</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Selection</span><span class="p">.</span><span class="nc">PickPoint</span><span class="p">(</span><span class="nn">ObjectSnapTypes</span><span class="p">.</span><span class="nc">Intersections</span><span class="p">,</span> <span class="s2">"Select intersection point"</span><span class="o">))</span>
      <span class="k">let</span> <span class="n">ln02</span> <span class="p">=</span> <span class="nn">Line</span><span class="p">.</span><span class="nc">CreateBound</span><span class="p">(</span><span class="n">threepoints</span><span class="o">.[</span><span class="mi">0</span><span class="o">],</span> <span class="n">threepoints</span><span class="o">.[</span><span class="mi">2</span><span class="o">])</span>
      <span class="k">let</span> <span class="n">ln21</span> <span class="p">=</span> <span class="nn">Line</span><span class="p">.</span><span class="nc">CreateBound</span><span class="p">(</span><span class="n">threepoints</span><span class="o">.[</span><span class="mi">2</span><span class="o">],</span> <span class="n">threepoints</span><span class="o">.[</span><span class="mi">1</span><span class="o">])</span>
      <span class="k">let</span> <span class="n">pars</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">..</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">..</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span>
      <span class="k">let</span> <span class="n">eval</span> <span class="p">(</span><span class="n">ln</span><span class="p">:</span><span class="nc">Curve</span><span class="o">)(</span><span class="n">par</span><span class="p">:</span><span class="kt">float</span><span class="p">)</span> <span class="p">=</span> <span class="n">ln</span><span class="p">.</span><span class="nc">Evaluate</span><span class="p">(</span><span class="n">par</span> <span class="p">*</span> <span class="n">ln</span><span class="p">.</span><span class="nc">Length</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span>
      <span class="k">let</span> <span class="n">pts02</span> <span class="p">=</span> <span class="n">pars</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="p">(</span><span class="n">eval</span> <span class="n">ln02</span><span class="p">)</span>
      <span class="k">let</span> <span class="n">pts21</span> <span class="p">=</span> <span class="n">pars</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="p">(</span><span class="n">eval</span> <span class="n">ln21</span><span class="p">)</span>
      <span class="k">let</span> <span class="n">t</span> <span class="p">=</span> <span class="k">new</span> <span class="nc">Transaction</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s2">"Create detaillines"</span><span class="p">)</span> 
      <span class="n">t</span><span class="p">.</span><span class="nc">Start</span><span class="bp">()</span> <span class="p">|&gt;</span> <span class="n">ignore</span>
      <span class="k">let</span> <span class="n">detaillines</span> <span class="p">=</span>
        <span class="nn">List</span><span class="p">.</span><span class="n">map2</span> <span class="p">(</span>
          <span class="k">fun</span> <span class="n">pa</span> <span class="n">pb</span> <span class="p">-&gt;</span> <span class="nn">Line</span><span class="p">.</span><span class="nc">CreateBound</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span> <span class="n">pb</span><span class="p">)</span> 
          <span class="p">)</span> <span class="n">pts02</span> <span class="n">pts21</span>
        <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="p">(</span>
          <span class="k">fun</span> <span class="p">(</span><span class="n">ln</span><span class="p">:</span><span class="nc">Line</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">doc</span><span class="p">.</span><span class="nn">Create</span><span class="p">.</span><span class="nc">NewDetailCurve</span><span class="p">(</span><span class="n">uidoc</span><span class="p">.</span><span class="nc">ActiveView</span><span class="p">,</span> <span class="n">ln</span><span class="p">)</span>
          <span class="p">)</span>
      <span class="n">t</span><span class="p">.</span><span class="nc">Commit</span><span class="bp">()</span> <span class="p">|&gt;</span> <span class="n">ignore</span>
      <span class="nn">Result</span><span class="p">.</span><span class="nc">Succeeded</span></code></pre></figure>

<p>The beginning of the type declaration is a routine job: UIApplication from the ExternalCommandData, ActiveUIDocument from the Application of the UIApplication and from the active UI document we get the database Document, i.e. where we have every drawn element stored.</p>

<p>The following of the code has a few things to note: To select arbitrary three points, we use PickPoint() method of Selection property of the ActiveUIDocument, where we can define, if we need to, which kind of ObjectSnapTypes we’d like to limit our point selection to. For the method calling, we can start with a number range from 0 til 2, use the pipeline to call the method three times and have the picked points as instances of XYZ in return. In this way, instead of using a for loop, passing the range list is like counting, then for each count you’ll have a point gained, and you have got a clear functional syntax. I found this is quite handy in reading codes.</p>

<p>Drawing lines is done by utilizing the CreateBound() method of the Line type, i.e. class, in the DB (database) namespace, by giving start and end points of the XYZ type. For the division of the lines, we’ll need to apply the parameters on each line, which are related to the dividing points. To get a point on curve – in this case it is a line – we use Valuate() method of the line class, which requires a parameter and a boolean inputs. A parameter on a line is a length input between the starting point to the inquired point along the curve. The second boolean input determines, when true, we only give a parameter between 0.0 and 1.0, considerung the line length is unitized. Here we give false to the if-unitized-input and by multipling the whole length with ratios between 0 and 1, we’ll have the length parameter. Again, by using pipeline syntax, we can start with a range of floating point numbers, as many as we want the lines to be split up, and then assign them to evaluate the points on each of the lines.</p>

<p>In Revit, for the modification of a document, a transaction must be declared. A transaction has a starting and a commiting points which mark the start and the end of it. In this way, when an error happens during the action, the whole process can be undone, to prevent the unwanted changes, i.e. the changes before the error point, to be left behind and hidden somewhere in the model. In the transaction mode, we use the map2 function of the List module of F# for mapping the points from one line to another, in the order of the start and end points of the two lines. To use the map2, mapping the CreateBound() method to each pair of the points, the length, i.e. numbers, of both point lists must be equal. After we have the list of the lines between the splitting points, we use List.map function to create each of them by mapping each line to the NewDetailCurve() function, method of the Create property of the Document, which also requires, firstly, the information of a View, where the lines should be drawn – in our case, I give the ActiveView from the current UIDocument (assuming we’re drawing in a 2 dimensional view and the view is active) – and secondly the curves, i.e. the lines. Since we are mapping each line one by one onto the view, we can use a lambda expression – at the left side of an arror, starting with the fun keyword to declare a lambda function, followed by the declaration of parameter, a Line type, value-bound with ln, and at the right side of the arrow is the return value – a detail curve created by each given ln value in the active view.</p>

<p>Finally, before we return a successfult result to finish the external command, we have to enter the commiting point to end the transaction and make the changes valid.</p>

<p>By the way, do not forget the namespace, adding references and assigning attributes declaration!</p>

<figure class="highlight"><pre><code class="language-fsharp" data-lang="fsharp"><span class="k">namespace</span> <span class="nn">TYB</span><span class="p">.</span><span class="nn">Tutorial</span><span class="p">.</span><span class="nc">Wordpress</span>

<span class="k">open</span> <span class="nn">Autodesk</span><span class="p">.</span><span class="nn">Revit</span><span class="p">.</span><span class="nc">UI</span>
<span class="k">open</span> <span class="nn">Autodesk</span><span class="p">.</span><span class="nn">Revit</span><span class="p">.</span><span class="nn">UI</span><span class="p">.</span><span class="nc">Selection</span>
<span class="k">open</span> <span class="nn">Autodesk</span><span class="p">.</span><span class="nn">Revit</span><span class="p">.</span><span class="nc">DB</span>
<span class="k">open</span> <span class="nn">Autodesk</span><span class="p">.</span><span class="nn">Revit</span><span class="p">.</span><span class="nc">Attributes</span></code></pre></figure>

<p>By doing coding with Revit API you’re learning and discovery Revit everyday deeper.</p>

<p>Stay tuned!</p>

  </div><a class="u-url" href="/revitexternalcommand/Create-Detail-Lines/" hidden></a>
</article>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">tailor . your . bim</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>© 2025 Chings e.U.</li>
          <li class="p-name">Ching</li><li><a class="u-email" href="mailto:info@tailoryourbim.com">info@tailoryourbim.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/chings-eu"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">chings-eu</span></a></li><li><a href="https://www.linkedin.com/in/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">tailoryourbim</span></a></li><li><a href="https://www.twitter.com/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">tailoryourbim</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>I&#39;m Ching, your BIM tailor.</p>
      </div>
    </div>

  </div>

</footer>
</body>
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</html>
