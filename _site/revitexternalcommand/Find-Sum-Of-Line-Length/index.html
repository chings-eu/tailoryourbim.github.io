<!DOCTYPE html>
<html lang="en"><head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5QTTTRNC1H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5QTTTRNC1H');
  </script>

  <meta property="og:image" content="https://discordapp.com/assets/ba74954dde74ff40a32ff58069e78c36.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="250">
  <meta property="og:image:height" content="250">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Find Sum Of Line Length | Tailor Your BIM</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Find Sum Of Line Length" />
<meta name="author" content="Ching" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ching’s here, your tailor for BIM." />
<meta property="og:description" content="Ching’s here, your tailor for BIM." />
<link rel="canonical" href="http://localhost:4000/revitexternalcommand/Find-Sum-Of-Line-Length/" />
<meta property="og:url" content="http://localhost:4000/revitexternalcommand/Find-Sum-Of-Line-Length/" />
<meta property="og:site_name" content="Tailor Your BIM" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-18T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Find Sum Of Line Length" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ching"},"dateModified":"2018-10-18T00:00:00+02:00","datePublished":"2018-10-18T00:00:00+02:00","description":"Ching’s here, your tailor for BIM.","headline":"Find Sum Of Line Length","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/revitexternalcommand/Find-Sum-Of-Line-Length/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logoty.png"},"name":"Ching"},"url":"http://localhost:4000/revitexternalcommand/Find-Sum-Of-Line-Length/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png"<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Tailor Your BIM" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><!-- <a class="site-title" rel="author" href="/">Tailor Your BIM</a> -->

    <a class="site-title" rel="author" href="/">
      <img src="/assets/img/logoty.png" alt="Logo" width="48px"> 
      <!-- <span>&nbsp;&nbsp;Tailor Your BIM</span> -->
        
      
      <!-- <span style='color: #B042FF;'>T</span>
      <span style='color: #939393;'>ailor . </span>
      <span style='color: #01bbd4;'>Y</span>
      <span style='color: #939393;'>our . BIM </span> -->
    </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/contact/">Contact</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>

<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Find Sum Of Line Length</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-10-18T00:00:00+02:00" itemprop="datePublished">Oct 18, 2018
      </time></p>
  </header>

  <div class="post-categories"><a herf="/categories/#RevitExternalCommand">RevitExternalCommand</a>&nbsp;|&nbsp;<a herf="/tags/#f#">f#</a>&nbsp;/&nbsp;<a herf="/tags/#revit api">revit api</a>&nbsp;/&nbsp;<a herf="/tags/#sum">sum</a>&nbsp;/&nbsp;<a herf="/tags/#length">length</a>&nbsp;/&nbsp;<a herf="/tags/#line">line</a></div>
  
  <div class="post-content e-content" itemprop="articleBody">
    <script src="/assets/signup/signup.js"></script>

<signup-component></signup-component>

<p>In Revit 2017, I haven’t find the way to see directly the sum of the line lengths by selecting line elements within the default Revit interface. However, it is relative easy to write a few lines of code and use the TaskDialog interface in Revit API to return the summed length. And here it goes…</p>

<p>在使用 Revit 2017 中，我至今尚未找到一個方法，當我選取多重線段時，可以直接得到總長度的方法。但事實上，寫幾行 F# 程式經由 Revit API 取得長度，配合 TaskDialog 介面呈現總長數值，來解決這個問題是相當簡單的。以下是一範例：</p>

<figure class="highlight"><pre><code class="language-fsharp" data-lang="fsharp"><span class="k">type</span> <span class="nc">FindSumLengthOfLines</span><span class="bp">()</span> <span class="k">as</span> <span class="n">this</span> <span class="p">=</span>
  <span class="k">interface</span> <span class="nc">IExternalCommand</span> <span class="k">with</span>
    <span class="k">member</span> <span class="n">x</span><span class="p">.</span><span class="nc">Execute</span><span class="p">(</span><span class="n">cdata</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">elset</span><span class="p">)</span> <span class="p">=</span>
      <span class="k">let</span> <span class="n">uidoc</span> <span class="p">=</span> <span class="n">cdata</span><span class="p">.</span><span class="nn">Application</span><span class="p">.</span><span class="nc">ActiveUIDocument</span>
      <span class="k">let</span> <span class="n">units</span> <span class="p">=</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nc">GetUnits</span><span class="bp">()</span>
      <span class="k">let</span> <span class="n">uf</span> <span class="p">=</span> <span class="n">units</span><span class="p">.</span><span class="nc">GetFormatOptions</span><span class="p">(</span><span class="nn">UnitType</span><span class="p">.</span><span class="nc">UT_Length</span><span class="o">).</span><span class="nc">DisplayUnits</span>
      <span class="k">let</span> <span class="n">factor</span><span class="p">,</span> <span class="n">tUnits</span> <span class="p">=</span>
        <span class="k">let</span> <span class="n">ary</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span> <span class="n">uf</span><span class="o">).</span><span class="nc">Split</span> <span class="k">'</span><span class="p">_</span><span class="k">'</span>
        <span class="k">match</span> <span class="nn">Array</span><span class="p">.</span><span class="n">contains</span> <span class="s2">"METERS"</span> <span class="n">ary</span> <span class="k">with</span>
          <span class="p">|</span> <span class="bp">true</span> <span class="p">-&gt;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3048</span><span class="p">,</span> <span class="s2">" m"</span>
          <span class="p">|</span> <span class="bp">false</span> <span class="p">-&gt;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="s2">" ft"</span>
      <span class="k">let</span> <span class="n">selected</span> <span class="p">=</span>
          <span class="n">uidoc</span><span class="p">.</span><span class="nn">Selection</span><span class="p">.</span><span class="nc">GetElementIds</span><span class="bp">()</span>
          <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span> <span class="n">uidoc</span><span class="p">.</span><span class="nn">Document</span><span class="p">.</span><span class="nc">GetElement</span>
          <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="k">fun</span> <span class="n">e</span> <span class="p">-&gt;</span>
              <span class="k">match</span> <span class="n">e</span> <span class="k">with</span>
              <span class="p">|</span> <span class="o">:?</span> <span class="nc">CurveElement</span> <span class="p">-&gt;</span> <span class="bp">true</span>
              <span class="p">|</span> <span class="p">_</span> <span class="p">-&gt;</span> <span class="bp">false</span>
          <span class="p">)</span> <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">cast</span> <span class="p">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">ofSeq</span>
      <span class="k">match</span> <span class="n">selected</span> <span class="k">with</span>
      <span class="p">|</span> <span class="bp">[]</span> <span class="p">-&gt;</span>
        <span class="n">msg</span>
        <span class="k">let</span> <span class="n">txt</span> <span class="p">=</span>
          <span class="n">selected</span>
          <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">fun</span> <span class="n">ce</span> <span class="p">-&gt;</span>
              <span class="n">ce</span><span class="p">.</span><span class="nn">GeometryCurve</span><span class="p">.</span><span class="nc">Length</span> <span class="p">*</span> <span class="n">factor</span>
              <span class="p">|&gt;</span> <span class="k">fun</span> <span class="n">x</span> <span class="p">-&gt;</span> <span class="n">x</span> <span class="p">*</span> <span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="o">**</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span> <span class="p">|&gt;</span> <span class="nn">Math</span><span class="p">.</span><span class="nc">Round</span>
              <span class="p">|&gt;</span> <span class="k">fun</span> <span class="n">x</span> <span class="p">-&gt;</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="o">**</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span>
          <span class="p">)</span> <span class="p">|&gt;</span> <span class="nn">Seq</span><span class="p">.</span><span class="n">sum</span> <span class="p">|&gt;</span> <span class="kt">string</span>
          <span class="nn">TaskDialog</span><span class="p">.</span><span class="nc">Show</span><span class="p">(</span><span class="s2">"Sum of length:"</span><span class="p">,</span> <span class="n">txt</span> <span class="o">+</span> <span class="n">tUnits</span><span class="p">)</span> <span class="p">|&gt;</span> <span class="n">ignore</span>
          <span class="nn">Result</span><span class="p">.</span><span class="nc">Succeeded</span></code></pre></figure>

<p>As usual, we pre-select elements prior to running this command. To note is that we set a filter aiming for the element which are the curve element (line), by comparing the type of each of the pre-selected elements. From the filtered curve elements, we retrieve their length (line). Here comes a fun part. Since we are not sure with which units we should show the length, there is a function at the beginning of the code to determine which units this document has, where we compare if the keyword “METERS” exists in the DisplayUnitType. If so, we have metric system here and multiply the factor as 0.3048 to the summed lengths in order to show them correctly, and if not, it is then imperial units and the factor is 1.0 and we also append a string, either “m” or “ft” to the end of the dimension.</p>

<p>Simple and short, we make our work more efficient and save our valuable time for the other fun part of life…</p>

<p><strong>勿忘參考 / References</strong>：</p>

<p>Start up an F# solution for Revit plug-in / 在 Visual Studio 中用 F# 編程 Revit 外部指令<br />
Run external command in Revit / 加入 Revit 外部指令<br />
Start coding F# library for Revit / 開始編程 Revit 的 F# 指令集</p>

  </div><a class="u-url" href="/revitexternalcommand/Find-Sum-Of-Line-Length/" hidden></a>
</article>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <p>
       <!-- <h2>Tailor Your BIM</h2> -->
      <!-- <h2 class="footer-heading">Tailor Your BIM</h2> -->
      <img src="/assets/img/logoty.png" alt="Logo" width="42px">
    </p>
    
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          
          <li>© 2025 Chings e.U.</li>
          <li class="p-name">Ching</li><li><a class="u-email" href="mailto:info@tailoryourbim.com">info@tailoryourbim.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/chings-eu"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">chings-eu</span></a></li><li><a href="https://www.linkedin.com/in/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">tailoryourbim</span></a></li><li><a href="https://www.twitter.com/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">tailoryourbim</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ching&#39;s here, your tailor for BIM.</p>
      </div>
    </div>

  </div>

</footer>
</body>
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</html>
