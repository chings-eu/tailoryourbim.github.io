<!DOCTYPE html>
<html lang="en"><head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5QTTTRNC1H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5QTTTRNC1H');
  </script>

  <meta property="og:image" content="https://discordapp.com/assets/ba74954dde74ff40a32ff58069e78c36.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="250">
  <meta property="og:image:height" content="250">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Rhino Plug-in with F# 用F#寫Rhino外掛程式 | Tailor Your BIM</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Rhino Plug-in with F# 用F#寫Rhino外掛程式" />
<meta name="author" content="Ching" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ching’s here, your tailor for BIM." />
<meta property="og:description" content="Ching’s here, your tailor for BIM." />
<link rel="canonical" href="http://localhost:4000/rhino/plug-in/Rhino-Plug-in-with-FSharp/" />
<meta property="og:url" content="http://localhost:4000/rhino/plug-in/Rhino-Plug-in-with-FSharp/" />
<meta property="og:site_name" content="Tailor Your BIM" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-11-14T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Rhino Plug-in with F# 用F#寫Rhino外掛程式" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ching"},"dateModified":"2018-11-14T00:00:00+01:00","datePublished":"2018-11-14T00:00:00+01:00","description":"Ching’s here, your tailor for BIM.","headline":"Rhino Plug-in with F# 用F#寫Rhino外掛程式","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/rhino/plug-in/Rhino-Plug-in-with-FSharp/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logoty.png"},"name":"Ching"},"url":"http://localhost:4000/rhino/plug-in/Rhino-Plug-in-with-FSharp/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png"<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Tailor Your BIM" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><!-- <a class="site-title" rel="author" href="/">Tailor Your BIM</a> -->

    <a class="site-title" rel="author" href="/">
      <img src="/assets/img/logoty.png" alt="Logo" width="48px"> 
      <!-- <span>&nbsp;&nbsp;Tailor Your BIM</span> -->
        
      
      <!-- <span style='color: #B042FF;'>T</span>
      <span style='color: #939393;'>ailor . </span>
      <span style='color: #01bbd4;'>Y</span>
      <span style='color: #939393;'>our . BIM </span> -->
    </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/contact/">Contact</a><a class="page-link" href="/tags/">Tags</a></div>
      </nav></div>
</header>

<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Rhino Plug-in with F# | 用F#寫Rhino外掛程式</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-11-14T00:00:00+01:00" itemprop="datePublished">Nov 14, 2018
      </time></p>
  </header>

  <div class="post-categories"><a herf="/categories/#Rhino">Rhino</a><a herf="/categories/#Plug-in">Plug-in</a>&nbsp;|&nbsp;<a herf="/tags/#f#">f#</a>&nbsp;/&nbsp;<a herf="/tags/#rhinocommon">rhinocommon</a></div>
  
  <div class="post-content e-content" itemprop="articleBody">
    <script src="/assets/signup/signup.js"></script>

<signup-component></signup-component>

<p>A few years back, when I was writing my thesis, titled “Permeation”, about philosophy, architectural geometry and programming, RhinoCommon, Grasshopper and Python were the great helpers to bring my ideas into the light. Since then, they are essential parts for my work along with Revit. When F# came to my life, it brought my understanding of programming further into a broader view and another level.</p>

<blockquote>
  <p>F# is a mature, open source, cross-platform, functional-first programming language. It empowers users and organizations to tackle complex computing problems with simple, maintainable and robust code. -<a href="http://fsharp.org">F# Software Foundation</a></p>
</blockquote>

<p>Parallel to introductions about writing external commands for Revit with Revit API in F# or Python, I’d like to share writing commands for Rhino with RhinoCommon in both languages as well.</p>

<p>Let’s start with adapting a Python code example from the Rhino Developer Docs samples: Custom Getpoint. We will build a dynamic-link library (.dll) as plug-in for the newest version Rhino 6, with its RhinoCommon.dll and Rhino.UI.dll as References. For building an dll file, we can use Visual Studio Community as coding environment, and you can find a similar post about setting it up. However, the difference is just instead of references from Revit, we’ll have to use the ones from Rhino 6.</p>

<figure class="highlight"><pre><code class="language-sharp" data-lang="sharp">namespace TYB.RHN.DOES
type PlugIn() =
  class
    inherit Rhino.PlugIns.PlugIn()
  end</code></pre></figure>

<p>Just like coding with Revit API – as mentioned in this previous post, we have to set the TransactionAttribute and using IExternalCommand interface for each external command – and here we’ll have to write, for RhinoCommon, at least, two types with similar setups – first, a type inheriting PlugIn as base class (code above) and, second, a type inheriting Command as base class (code below). We can have many of the types that inherit Command class, but we must have one type which inherits the PlugIn class within one project, i. e.  within one dynamic-link library (.dll) file.</p>

<figure class="highlight"><pre><code class="language-fsharp" data-lang="fsharp"><span class="k">namespace</span> <span class="nn">TYB</span><span class="p">.</span><span class="nn">RHN</span><span class="p">.</span><span class="nc">Does</span>
<span class="k">open</span> <span class="nc">Rhino</span>
<span class="k">open</span> <span class="nn">Rhino</span><span class="p">.</span><span class="nc">Geometry</span>
<span class="k">open</span> <span class="nn">Rhino</span><span class="p">.</span><span class="nc">Input</span>
<span class="k">type</span> <span class="nc">DrawDynamicLines</span><span class="bp">()</span> <span class="k">as</span> <span class="n">this</span> <span class="p">=</span>
  <span class="k">inherit</span> <span class="nn">Rhino</span><span class="p">.</span><span class="nn">Commands</span><span class="p">.</span><span class="nc">Command</span><span class="bp">()</span>
  <span class="k">override</span> <span class="n">x</span><span class="p">.</span><span class="nc">EnglishName</span> <span class="p">=</span> <span class="kt">string</span> <span class="n">this</span>
  <span class="k">override</span> <span class="n">x</span><span class="p">.</span><span class="nc">RunCommand</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="p">=</span>
    <span class="nn">RhinoApp</span><span class="p">.</span><span class="nc">WriteLine</span><span class="p">(</span><span class="kt">string</span> <span class="n">this</span><span class="p">)</span>
    <span class="k">let</span> <span class="n">gp0</span> <span class="p">=</span> <span class="nn">RhinoGet</span><span class="p">.</span><span class="nc">GetPoint</span><span class="p">(</span><span class="s2">"Pick a point"</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span>
    <span class="k">let</span> <span class="n">gp1</span> <span class="p">=</span> <span class="nn">RhinoGet</span><span class="p">.</span><span class="nc">GetPoint</span><span class="p">(</span><span class="s2">"Pick 2nd point"</span><span class="p">,</span> <span class="bp">true</span><span class="p">)</span>
    <span class="k">let</span> <span class="n">points</span> <span class="p">=</span>
      <span class="k">match</span> <span class="n">gp0</span><span class="p">,</span> <span class="n">gp1</span> <span class="k">with</span>
      <span class="p">|</span> <span class="o">(_,</span> <span class="n">pt0</span><span class="o">),</span> <span class="o">(_,</span> <span class="n">pt1</span><span class="p">)</span> <span class="p">-&gt;</span>
        <span class="p">[</span><span class="n">pt0</span><span class="p">;</span> <span class="n">pt1</span><span class="p">]</span>
    <span class="k">let</span> <span class="n">gp2</span> <span class="p">=</span> <span class="k">new</span> <span class="nn">Rhino</span><span class="p">.</span><span class="nn">Input</span><span class="p">.</span><span class="nn">Custom</span><span class="p">.</span><span class="nc">GetPoint</span><span class="bp">()</span>
    <span class="n">gp2</span><span class="p">.</span><span class="nn">DynamicDraw</span><span class="p">.</span><span class="nc">Add</span><span class="p">(</span>
      <span class="k">fun</span> <span class="n">arg</span> <span class="p">-&gt;</span>
        <span class="n">arg</span><span class="p">.</span><span class="nn">Display</span><span class="p">.</span><span class="nc">DrawLine</span><span class="p">(</span><span class="n">points</span><span class="o">.[</span><span class="mi">0</span><span class="o">],</span> <span class="n">arg</span><span class="p">.</span><span class="nc">CurrentPoint</span><span class="p">,</span> <span class="nn">System</span><span class="p">.</span><span class="nn">Drawing</span><span class="p">.</span><span class="nn">Color</span><span class="p">.</span><span class="nc">AliceBlue</span><span class="p">)</span>
        <span class="n">arg</span><span class="p">.</span><span class="nn">Display</span><span class="p">.</span><span class="nc">DrawLine</span><span class="p">(</span><span class="n">points</span><span class="o">.[</span><span class="mi">1</span><span class="o">],</span> <span class="n">arg</span><span class="p">.</span><span class="nc">CurrentPoint</span><span class="p">,</span> <span class="nn">System</span><span class="p">.</span><span class="nn">Drawing</span><span class="p">.</span><span class="nn">Color</span><span class="p">.</span><span class="nc">HotPink</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">gp2</span><span class="p">.</span><span class="nc">Get</span><span class="bp">()</span>
    <span class="n">doc</span><span class="p">.</span><span class="nn">Views</span><span class="p">.</span><span class="nc">Redraw</span><span class="bp">()</span>
    <span class="nn">Commands</span><span class="p">.</span><span class="nn">Result</span><span class="p">.</span><span class="nc">Success</span> </code></pre></figure>

<p>Just as I felt, as I slowly learnt how to write in F# with the understanding of Python, translating from Python code to F# is easy. The most different part might be to declare a type, to inherit a class and override the name of this command and the RunCommand() method. Since I didn’t have to do those. If you’re using Python editor or writing Python script in Grasshopper, these processes are not necessary, since these are already taken care of.</p>

<p>The process of this code is clear and similar to the one in Python. By overriding the EnglishName, we can set the name of this command to be called in Rhino command line and under RunCommand we implement what this code is actually doing. By using RhinoGet, the user enter the two points on screen and the third one we set for the CurrentPoint, where your mouse cursor is located, from the event argument of DynamicDraw event.</p>

<p>Finally, build this solution in Visual Studio, you’ll have a dynamic-link library file (.dll). In Rhino 6 under Option » Plug-in, you can import this command and call it from the command line.</p>

  </div><a class="u-url" href="/rhino/plug-in/Rhino-Plug-in-with-FSharp/" hidden></a>
</article>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <p>
       <!-- <h2>Tailor Your BIM</h2> -->
      <!-- <h2 class="footer-heading">Tailor Your BIM</h2> -->
      <img src="/assets/img/logoty.png" alt="Logo" width="42px">
    </p>
    
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          
          <li>© 2025 Chings e.U.</li>
          <li class="p-name">Ching</li><li><a class="u-email" href="mailto:info@tailoryourbim.com">info@tailoryourbim.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/chings-eu"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">chings-eu</span></a></li><li><a href="https://www.linkedin.com/in/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">tailoryourbim</span></a></li><li><a href="https://www.twitter.com/tailoryourbim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">tailoryourbim</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ching&#39;s here, your tailor for BIM.</p>
      </div>
    </div>

  </div>

</footer>
</body>
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="chings" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting!" data-color="#8564a2" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</html>
